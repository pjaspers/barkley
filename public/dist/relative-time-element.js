var t=(void 0,function(t,e,s,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e==="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,s):n?n.value=s:e.set(t,s),s});var e=(void 0,function(t,e,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e==="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(t):i?i.value:e.get(t)});var s;class ListFormatPonyFill{formatToParts(t){const e=[];for(const s of t){e.push({type:"element",value:s});e.push({type:"literal",value:", "})}return e.slice(0,-1)}}const i=typeof Intl!=="undefined"&&Intl.ListFormat||ListFormatPonyFill;const n=[["years","year"],["months","month"],["weeks","week"],["days","day"],["hours","hour"],["minutes","minute"],["seconds","second"],["milliseconds","millisecond"]];const a={minimumIntegerDigits:2};class DurationFormat{constructor(e,i={}){s.set(this,void 0);let n=String(i.style||"short");n!=="long"&&n!=="short"&&n!=="narrow"&&n!=="digital"&&(n="short");let a=n==="digital"?"numeric":n;const o=i.hours||a;a=o==="2-digit"?"numeric":o;const r=i.minutes||a;a=r==="2-digit"?"numeric":r;const h=i.seconds||a;a=h==="2-digit"?"numeric":h;const l=i.milliseconds||a;t(this,s,{locale:e,style:n,years:i.years||n==="digital"?"short":n,yearsDisplay:i.yearsDisplay==="always"?"always":"auto",months:i.months||n==="digital"?"short":n,monthsDisplay:i.monthsDisplay==="always"?"always":"auto",weeks:i.weeks||n==="digital"?"short":n,weeksDisplay:i.weeksDisplay==="always"?"always":"auto",days:i.days||n==="digital"?"short":n,daysDisplay:i.daysDisplay==="always"?"always":"auto",hours:o,hoursDisplay:i.hoursDisplay==="always"||n==="digital"?"always":"auto",minutes:r,minutesDisplay:i.minutesDisplay==="always"||n==="digital"?"always":"auto",seconds:h,secondsDisplay:i.secondsDisplay==="always"||n==="digital"?"always":"auto",milliseconds:l,millisecondsDisplay:i.millisecondsDisplay==="always"?"always":"auto"},"f")}resolvedOptions(){return e(this,s,"f")}formatToParts(t){const o=[];const r=e(this,s,"f");const h=r.style;const l=r.locale;for(const[e,s]of n){const i=t[e];if(r[`${e}Display`]==="auto"&&!i)continue;const n=r[e];const h=n==="2-digit"?a:n==="numeric"?{}:{style:"unit",unit:s,unitDisplay:n};o.push(new Intl.NumberFormat(l,h).format(i))}return new i(l,{type:"unit",style:h==="digital"?"short":h}).formatToParts(o)}format(t){return this.formatToParts(t).map((t=>t.value)).join("")}}s=new WeakMap;const o=/^[-+]?P(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?(?:T(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?)?$/;const r=["year","month","week","day","hour","minute","second","millisecond"];const isDuration=t=>o.test(t);class Duration{constructor(t=0,e=0,s=0,i=0,n=0,a=0,o=0,r=0){this.years=t;this.months=e;this.weeks=s;this.days=i;this.hours=n;this.minutes=a;this.seconds=o;this.milliseconds=r;this.years||(this.years=0);this.sign||(this.sign=Math.sign(this.years));this.months||(this.months=0);this.sign||(this.sign=Math.sign(this.months));this.weeks||(this.weeks=0);this.sign||(this.sign=Math.sign(this.weeks));this.days||(this.days=0);this.sign||(this.sign=Math.sign(this.days));this.hours||(this.hours=0);this.sign||(this.sign=Math.sign(this.hours));this.minutes||(this.minutes=0);this.sign||(this.sign=Math.sign(this.minutes));this.seconds||(this.seconds=0);this.sign||(this.sign=Math.sign(this.seconds));this.milliseconds||(this.milliseconds=0);this.sign||(this.sign=Math.sign(this.milliseconds));this.blank=this.sign===0}abs(){return new Duration(Math.abs(this.years),Math.abs(this.months),Math.abs(this.weeks),Math.abs(this.days),Math.abs(this.hours),Math.abs(this.minutes),Math.abs(this.seconds),Math.abs(this.milliseconds))}static from(t){var e;if(typeof t==="string"){const s=String(t).trim();const i=s.startsWith("-")?-1:1;const n=(e=s.match(o))===null||e===void 0?void 0:e.slice(1).map((t=>(Number(t)||0)*i));return n?new Duration(...n):new Duration}if(typeof t==="object"){const{years:e,months:s,weeks:i,days:n,hours:a,minutes:o,seconds:r,milliseconds:h}=t;return new Duration(e,s,i,n,a,o,r,h)}throw new RangeError("invalid duration")}static compare(t,e){const s=Date.now();const i=Math.abs(applyDuration(s,Duration.from(t)).getTime()-s);const n=Math.abs(applyDuration(s,Duration.from(e)).getTime()-s);return i>n?-1:i<n?1:0}toLocaleString(t,e){return new DurationFormat(t,e).format(this)}}function applyDuration(t,e){const s=new Date(t);s.setFullYear(s.getFullYear()+e.years);s.setMonth(s.getMonth()+e.months);s.setDate(s.getDate()+e.weeks*7+e.days);s.setHours(s.getHours()+e.hours);s.setMinutes(s.getMinutes()+e.minutes);s.setSeconds(s.getSeconds()+e.seconds);return s}function elapsedTime(t,e="second",s=Date.now()){const i=t.getTime()-s;if(i===0)return new Duration;const n=Math.sign(i);const a=Math.abs(i);const o=Math.floor(a/1e3);const h=Math.floor(o/60);const l=Math.floor(h/60);const u=Math.floor(l/24);const m=Math.floor(u/30);const c=Math.floor(m/12);const d=r.indexOf(e)||r.length;return new Duration(d>=0?c*n:0,d>=1?(m-c*12)*n:0,0,d>=3?(u-m*30)*n:0,d>=4?(l-u*24)*n:0,d>=5?(h-l*60)*n:0,d>=6?(o-h*60)*n:0,d>=7?(a-o*1e3)*n:0)}function roundToSingleUnit(t,{relativeTo:e=Date.now()}={}){e=new Date(e);if(t.blank)return t;const s=t.sign;let i=Math.abs(t.years);let n=Math.abs(t.months);let a=Math.abs(t.weeks);let o=Math.abs(t.days);let r=Math.abs(t.hours);let h=Math.abs(t.minutes);let l=Math.abs(t.seconds);let u=Math.abs(t.milliseconds);u>=900&&(l+=Math.round(u/1e3));(l||h||r||o||a||n||i)&&(u=0);l>=55&&(h+=Math.round(l/60));(h||r||o||a||n||i)&&(l=0);h>=55&&(r+=Math.round(h/60));(r||o||a||n||i)&&(h=0);o&&r>=12&&(o+=Math.round(r/24));!o&&r>=21&&(o+=Math.round(r/24));(o||a||n||i)&&(r=0);const m=e.getFullYear();let c=e.getMonth();const d=e.getDate();if(o>=27||i+n+o){const t=new Date(e);t.setFullYear(m+i*s);t.setMonth(c+n*s);t.setDate(d+o*s);const r=t.getFullYear()-e.getFullYear();const h=t.getMonth()-e.getMonth();const l=Math.abs(Math.round((Number(t)-Number(e))/864e5));const u=Math.abs(r*12+h);if(l<27){if(o>=6){a+=Math.round(o/7);o=0}else o=l;n=i=0}else if(u<11){n=u;i=0}else{n=0;i=r*s}(n||i)&&(o=0);c=e.getMonth()}i&&(n=0);a>=4&&(n+=Math.round(a/4));(n||i)&&(a=0);if(o&&a&&!n&&!i){a+=Math.round(o/7);o=0}return new Duration(i*s,n*s,a*s,o*s,r*s,h*s,l*s,u*s)}function getRelativeTimeUnit(t,e){const s=roundToSingleUnit(t,e);if(s.blank)return[0,"second"];for(const t of r){if(t==="millisecond")continue;const e=s[`${t}s`];if(e)return[e,t]}return[0,"second"]}var h=(void 0,function(t,e,s,i){if(s==="a"&&!i)throw new TypeError("Private accessor was defined without a getter");if(typeof e==="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return s==="m"?i:s==="a"?i.call(t):i?i.value:e.get(t)});var l=(void 0,function(t,e,s,i,n){if(i==="m")throw new TypeError("Private method is not writable");if(i==="a"&&!n)throw new TypeError("Private accessor was defined without a setter");if(typeof e==="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return i==="a"?n.call(t,s):n?n.value=s:e.set(t,s),s});var u,m,c,d,f,g,y,w,p,v,b;const M=globalThis.HTMLElement||null;const D=new Duration;const T=new Duration(0,0,0,0,0,1);class RelativeTimeUpdatedEvent extends Event{constructor(t,e,s,i){super("relative-time-updated",{bubbles:true,composed:true});this.oldText=t;this.newText=e;this.oldTitle=s;this.newTitle=i}}function getUnitFactor(t){if(!t.date)return Infinity;if(t.format==="duration"||t.format==="elapsed"){const e=t.precision;if(e==="second")return 1e3;if(e==="minute")return 6e4}const e=Math.abs(Date.now()-t.date.getTime());return e<6e4?1e3:e<36e5?6e4:36e5}const A=new class{constructor(){this.elements=new Set;this.time=Infinity;this.timer=-1}observe(t){if(this.elements.has(t))return;this.elements.add(t);const e=t.date;if(e&&e.getTime()){const e=getUnitFactor(t);const s=Date.now()+e;if(s<this.time){clearTimeout(this.timer);this.timer=setTimeout((()=>this.update()),e);this.time=s}}}unobserve(t){this.elements.has(t)&&this.elements.delete(t)}update(){clearTimeout(this.timer);if(!this.elements.size)return;let t=Infinity;for(const e of this.elements){t=Math.min(t,getUnitFactor(e));e.update()}this.time=Math.min(36e5,t);this.timer=setTimeout((()=>this.update()),this.time);this.time+=Date.now()}};class RelativeTimeElement extends M{constructor(){super(...arguments);u.add(this);m.set(this,false);c.set(this,false);f.set(this,this.shadowRoot?this.shadowRoot:this.attachShadow?this.attachShadow({mode:"open"}):this);b.set(this,null)}static define(t="relative-time",e=customElements){e.define(t,this);return this}static get observedAttributes(){return["second","minute","hour","weekday","day","month","year","time-zone-name","prefix","threshold","tense","precision","format","format-style","datetime","lang","title"]}get onRelativeTimeUpdated(){return h(this,b,"f")}set onRelativeTimeUpdated(t){h(this,b,"f")&&this.removeEventListener("relative-time-updated",h(this,b,"f"));l(this,b,typeof t==="object"||typeof t==="function"?t:null,"f");typeof t==="function"&&this.addEventListener("relative-time-updated",t)}get second(){const t=this.getAttribute("second");if(t==="numeric"||t==="2-digit")return t}set second(t){this.setAttribute("second",t||"")}get minute(){const t=this.getAttribute("minute");if(t==="numeric"||t==="2-digit")return t}set minute(t){this.setAttribute("minute",t||"")}get hour(){const t=this.getAttribute("hour");if(t==="numeric"||t==="2-digit")return t}set hour(t){this.setAttribute("hour",t||"")}get weekday(){const t=this.getAttribute("weekday");return t==="long"||t==="short"||t==="narrow"?t:this.format==="datetime"&&t!==""?this.formatStyle:void 0}set weekday(t){this.setAttribute("weekday",t||"")}get day(){var t;const e=(t=this.getAttribute("day"))!==null&&t!==void 0?t:"numeric";if(e==="numeric"||e==="2-digit")return e}set day(t){this.setAttribute("day",t||"")}get month(){const t=this.format;let e=this.getAttribute("month");if(e!==""){e!==null&&e!==void 0?e:e=t==="datetime"?this.formatStyle:"short";return e==="numeric"||e==="2-digit"||e==="short"||e==="long"||e==="narrow"?e:void 0}}set month(t){this.setAttribute("month",t||"")}get year(){var t;const e=this.getAttribute("year");return e==="numeric"||e==="2-digit"?e:this.hasAttribute("year")||(new Date).getUTCFullYear()===((t=this.date)===null||t===void 0?void 0:t.getUTCFullYear())?void 0:"numeric"}set year(t){this.setAttribute("year",t||"")}get timeZoneName(){const t=this.getAttribute("time-zone-name");if(t==="long"||t==="short"||t==="shortOffset"||t==="longOffset"||t==="shortGeneric"||t==="longGeneric")return t}set timeZoneName(t){this.setAttribute("time-zone-name",t||"")}get prefix(){var t;return(t=this.getAttribute("prefix"))!==null&&t!==void 0?t:this.format==="datetime"?"":"on"}set prefix(t){this.setAttribute("prefix",t)}get threshold(){const t=this.getAttribute("threshold");return t&&isDuration(t)?t:"P30D"}set threshold(t){this.setAttribute("threshold",t)}get tense(){const t=this.getAttribute("tense");return t==="past"?"past":t==="future"?"future":"auto"}set tense(t){this.setAttribute("tense",t)}get precision(){const t=this.getAttribute("precision");return r.includes(t)?t:this.format==="micro"?"minute":"second"}set precision(t){this.setAttribute("precision",t)}get format(){const t=this.getAttribute("format");return t==="datetime"?"datetime":t==="relative"?"relative":t==="duration"?"duration":t==="micro"?"micro":t==="elapsed"?"elapsed":"auto"}set format(t){this.setAttribute("format",t)}get formatStyle(){const t=this.getAttribute("format-style");if(t==="long")return"long";if(t==="short")return"short";if(t==="narrow")return"narrow";const e=this.format;return e==="elapsed"||e==="micro"?"narrow":e==="datetime"?"short":"long"}set formatStyle(t){this.setAttribute("format-style",t)}get datetime(){return this.getAttribute("datetime")||""}set datetime(t){this.setAttribute("datetime",t)}get date(){const t=Date.parse(this.datetime);return Number.isNaN(t)?null:new Date(t)}set date(t){this.datetime=(t===null||t===void 0?void 0:t.toISOString())||""}connectedCallback(){this.update()}disconnectedCallback(){A.unobserve(this)}attributeChangedCallback(t,e,s){if(e!==s){t==="title"&&l(this,m,s!==null&&(this.date&&h(this,u,"m",g).call(this,this.date))!==s,"f");h(this,c,"f")||t==="title"&&h(this,m,"f")||l(this,c,(async()=>{await Promise.resolve();this.update()})(),"f")}}update(){const t=h(this,f,"f").textContent||this.textContent||"";const e=this.getAttribute("title")||"";let s=e;const i=this.date;if(typeof Intl==="undefined"||!Intl.DateTimeFormat||!i){h(this,f,"f").textContent=t;return}const n=Date.now();if(!h(this,m,"f")){s=h(this,u,"m",g).call(this,i)||"";s&&this.setAttribute("title",s)}const a=elapsedTime(i,this.precision,n);const o=h(this,u,"m",y).call(this,a);let r=t;r=o==="duration"?h(this,u,"m",w).call(this,a):o==="relative"?h(this,u,"m",p).call(this,a):h(this,u,"m",v).call(this,i);r?h(this,f,"f").textContent=r:this.shadowRoot===h(this,f,"f")&&this.textContent&&(h(this,f,"f").textContent=this.textContent);r===t&&s===e||this.dispatchEvent(new RelativeTimeUpdatedEvent(t,r,e,s));o==="relative"||o==="duration"?A.observe(this):A.unobserve(this);l(this,c,false,"f")}}m=new WeakMap,c=new WeakMap,f=new WeakMap,b=new WeakMap,u=new WeakSet,d=function _RelativeTimeElement_lang_get(){var t;return((t=this.closest("[lang]"))===null||t===void 0?void 0:t.getAttribute("lang"))||this.ownerDocument.documentElement.getAttribute("lang")||"default"},g=function _RelativeTimeElement_getFormattedTitle(t){return new Intl.DateTimeFormat(h(this,u,"a",d),{day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"}).format(t)},y=function _RelativeTimeElement_resolveFormat(t){const e=this.format;if(e==="datetime")return"datetime";if(e==="duration")return"duration";if(e==="elapsed")return"duration";if(e==="micro")return"duration";if((e==="auto"||e==="relative")&&typeof Intl!=="undefined"&&Intl.RelativeTimeFormat){const e=this.tense;if(e==="past"||e==="future")return"relative";if(Duration.compare(t,this.threshold)===1)return"relative"}return"datetime"},w=function _RelativeTimeElement_getDurationFormat(t){const e=h(this,u,"a",d);const s=this.format;const i=this.formatStyle;const n=this.tense;let a=D;if(s==="micro"){t=roundToSingleUnit(t);a=T;(this.tense==="past"&&t.sign!==-1||this.tense==="future"&&t.sign!==1)&&(t=T)}else(n==="past"&&t.sign!==-1||n==="future"&&t.sign!==1)&&(t=a);const o=`${this.precision}sDisplay`;return t.blank?a.toLocaleString(e,{style:i,[o]:"always"}):t.abs().toLocaleString(e,{style:i})},p=function _RelativeTimeElement_getRelativeFormat(t){const e=new Intl.RelativeTimeFormat(h(this,u,"a",d),{numeric:"auto",style:this.formatStyle});const s=this.tense;s==="future"&&t.sign!==1&&(t=D);s==="past"&&t.sign!==-1&&(t=D);const[i,n]=getRelativeTimeUnit(t);return n==="second"&&i<10?e.format(0,"second"):e.format(i,n)},v=function _RelativeTimeElement_getDateTimeFormat(t){const e=new Intl.DateTimeFormat(h(this,u,"a",d),{second:this.second,minute:this.minute,hour:this.hour,weekday:this.weekday,day:this.day,month:this.month,year:this.year,timeZoneName:this.timeZoneName});return`${this.prefix} ${e.format(t)}`.trim()};export{RelativeTimeElement,RelativeTimeUpdatedEvent,RelativeTimeElement as default};
//# sourceMappingURL=relative-time-element.js.map
